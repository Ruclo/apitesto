base-urls:
  default: http://localhost:5432
  url1: http://localhost:8000
  url2: http://localhost:8080/api

groups:
  global:
    request-headers:
    - "Authorization: Bearer ${ENV_API_TOKEN}"
    query-parameters:
      id: 12
    expected:
      headers:
        - !X-Deprecated-Header

  group1:
    request-headers:
      - Authorization: Bearer ......asd

  
functional-tests:
  - name: "Get users/5"
    url: "/users"
    method: GET
    request-headers: 
      - Authorization: Bearer ...
    query-parameters:
      id: 5
    path-parameters:
      id: 5
    groups:
      - common-options1
    expected:
      status: 200
      response-schema: 
        type: object
        properties:
          id : { type: integer }
          name: { type: string, minLength: 1 }
          email: { type: string, format: email }
          address:
            type: object
            properties:
              street: { type: string }
              city: { type: string }
              zipcode: { type: string, pattern: '^/d{5}$' }
      headers:
        - Content-Type: application/json
        - X-Custom-Header
        - !X-Deprecated-Header
        - X-Security-Header: !weak
      assertions:
        - "$.id >= 0"

load-tests:
  - name: "GET /users Load Test"
    url: /users
    method: GET
    request-headers:
      - X-ANY-HEADER
    groups:
      - common-options1
    phases:
      - name: "Ramp-Up"
        duration: 3ms/s/m/h [l]e
        rps: 1000
        ccs: 100
      - name: "Peak"
        duration: 20m
        rps: 1000
        ccs: 100
      - name: "Cool-Down"
        duration: 30s
        rps: 50
        ccs: 10
    think-time:
      min: 100ms
      max: 500ms
    timeout:
      connect: 500ms
      request: 2s
    success-criteria:
      - "error_rate < 1%"
      - "p90_response_time < 200ms"
